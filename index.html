<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="SIBAP prototyping : ScrIpt-Based Aspect-oriented Prototyping framework">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>SIBAP prototyping</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/pedromateo/sibap">View on GitHub</a>

          <h1 id="project_title">SIBAP prototyping</h1>
          <h2 id="project_tagline">ScrIpt-Based Aspect-oriented Prototyping framework</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/pedromateo/sibap/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/pedromateo/sibap/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p><strong>This implementation corresponds to a research work. It is ready to be downloaded and integrated into Qt/C++ projects. It uses Lua as the prototyping language</strong></p>

<p>First of all, watch this ;-)
<a href="https://www.youtube.com/watch?v=H9-wh-08BSg">https://www.youtube.com/watch?v=H9-wh-08BSg</a></p>

<p>This framework proposes to treat prototyping as a separate aspect of the agile development process.
Prototype designs are completely reused and iteratively refined towards the
final GUI design. In parallel, final functionality is implemented and
smoothly integrated into the prototype replacing prototyped behaviors.</p>

<p>The design and implementation of a framework supporting this approach is
presented. It uses separate files to define prototyped behaviors, which are written
using general-purpose scripting languages and executed by an
interpreter. The GUI and the final functionality run natively.
Native and interpreted functionality coexist and run in parallel within the
application.</p>

<p>As a result, developers and UX designers work in parallel, separately, but
collaborating on the same software artifact. This encourages communication
during development. Scripting languages allow also to change the prototype on-the-fly in order
to incorporate suggestions from different stakeholders in real time. This
allows to gather feedback more effectively by implementing participatory
design techniques.</p>

<h2>
<a id="running-example" class="anchor" href="#running-example" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Running example</h2>

<p>While the SIBAP framework is included in <code>sibapfw</code> folder, an example including this
framework is included in <code>test</code> folder. </p>

<p>This example can be easily opened, compiled and run with 
QtCreator (<a href="https://www.qt.io/ide/">https://www.qt.io/ide/</a>). 
Behavior files are included in <code>behavior</code> folder. 
An execution log can be found at <code>/tmp/sibap_behavior.log</code>.</p>

<h2>
<a id="framework-integration" class="anchor" href="#framework-integration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Framework integration</h2>

<p>The integration process is divided into two stages: configuration and deployment.</p>

<p>Stage 1: Configuration. The process is easily configured using a BehaviorConfiguration
object. This object encapsulates all configuration data needed during execution (e.g., the di-rectory of behavior files or refreshing time) It can be instantiated from a configuration file:</p>

<pre><code>int main(int argc, char *argv[])
{
    QApplication qapp(argc, argv);
    MainWindow w;
    w.show();

    ///
    /// behavior layer configuration

    // Alternative 1
    //BehaviorConfiguration bconf("../layer.config");

    // Alternative 2
    //BehaviorConfiguration bconf;
    //bconf.loadConfigFile("layer.config");

    // Alternative 3
    BehaviorConfiguration bconf;
    bconf.updateFileTime(10)
         .logFormat("[%tm] %wi Event:%en :: State: %cs :: Assertion: %ar :: Function Called: %fc :: Result: %fr")
         .addLogOutputFile("/tmp/sibap_behavior.log")
         .addScriptPath("./test/behavior/");

    // You can also configure if the log info goes to the screen.
    // Available parameters are on,off
    // StandardOutput=on
    // StandardError=off
...
</code></pre>

<p>Stage 2: Deployment. Once the configuration object is created, it is used to create and configure a new BehaviorLayer. The BehaviorLayer object encapsulates the whole prototyping framework. Once created, the
init() method is called to deploy and start the behavior service:</p>

<pre><code>...
    ///
    /// behavior layer deployment

    QtLua_BehaviorLayer blayer(&amp;bconf);
    blayer.init();

    ///

    return qapp.exec();
}
</code></pre>

<h2>
<a id="framework-functions" class="anchor" href="#framework-functions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Framework functions</h2>

<h3>
<a id="main-function-template" class="anchor" href="#main-function-template" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Main function template</h3>

<pre><code>state_stateID__event__widget()  // Executed when event is performed on widget 
                                // being in state stateID. state stateID is optional.
</code></pre>

<h3>
<a id="initialization-functions" class="anchor" href="#initialization-functions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Initialization functions</h3>

<pre><code>init__widget()                  // Initialization of widget
state_stateID__widget()         // Initialization of widget when stateID is enabled
</code></pre>

<p>Example:</p>

<pre><code>function init__di_ampliLevel()
    __log("Initializing dials")
    MainWindow.di_ampliLevel:setValue(50)
    MainWindow.di_signalEcho:setValue(50)
    MainWindow.di_nrLevel:setValue(50)
    MainWindow.di_volumeLevel:setValue(50)
end
</code></pre>

<h3>
<a id="state-functions" class="anchor" href="#state-functions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>State functions</h3>

<pre><code>state__stateID()                // Does transition to state stateID. (State functions
                                // are automatically defined by SIBAP).
</code></pre>

<h3>
<a id="assert-functions" class="anchor" href="#assert-functions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Assert functions</h3>

<pre><code>assert__widget()                // Assertion for a widget must be satisfied for its
                                // behavior functions to be executed.
</code></pre>

<p>Example:</p>

<pre><code>function assert__hs_balanceLevel()
   __log("Asserting balance")
   balance=MainWindow.hs_balanceLevel:value()
   return balance &gt;= 0 and balance &lt;= 99
end
</code></pre>

<h3>
<a id="logging-functions" class="anchor" href="#logging-functions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Logging functions</h3>

<pre><code>log__widget()                   // Executed when widget is interacted
event__log()                    // Executed when event is performed
__log(content)                  // Adds content to log streams
__flog(fileName,content)        // Adds content to the file fileName
</code></pre>

<h3>
<a id="supporting-functions" class="anchor" href="#supporting-functions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Supporting functions</h3>

<p>All the expressiveness of the scripting language
(Lua in this case) and its interpreter can be used to define the behavior
of a GUI. Variables, data structures, supporting functions, etc. can be
used in the behavior functions to compute additional values and build
high-quality prototypes.</p>

<p>Examples:</p>

<pre><code>function calculatePower()
   power=buffer_size * 0.5 + sample_rate * 0.5
   ...
end

function setChannelsValue()
   aux=power*2
   MainWindow.pb_left:setValue(power * ((100-balance)/100)*2)
   ...
end

function updateValues()
   calculatePower()
   setChannelsValue()
end
</code></pre>

<h2>
<a id="framework-events" class="anchor" href="#framework-events" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Framework events</h2>

<p>All the following scene events (i.e., those application events related to user 
interaction) are supported by SIBAP, thus can be used to define behavior functions:</p>

<ul>
<li><code>click</code></li>
<li><code>doubleclick</code></li>
<li><code>wheel</code></li>
<li><code>focusin</code></li>
<li><code>focusout</code></li>
<li><code>mouseoverenter</code></li>
<li><code>mouseoverleave</code></li>
<li><code>mouseovermove</code></li>
<li><code>keypress</code></li>
<li><code>keyrelease</code></li>
<li><code>show</code></li>
<li><code>hide</code></li>
<li><code>repaint</code></li>
</ul>

<p>Examples:</p>

<pre><code>function click__di_ampliLevel()
   __log("Changing amplification")
   amplification=MainWindow.di_ampliLevel:value()
   MainWindow.lc_ampliLevel:display(amplification)
   updateValues() -- supporting functions can be used as well
end

function wheel__hs_balanceLevel()
   __log("Changing balance")
   balance=MainWindow.hs_balanceLevel:value()
   updateValues()
end
</code></pre>

<h2>
<a id="prototype-initialization" class="anchor" href="#prototype-initialization" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Prototype initialization</h2>

<p>Designers start creating a file, say initialization.lua, to define how the
values in the prototype GUI are initialized. This file is included in the directory
behavior/MainWindow/ to indicate that this behavior file corresponds to the dialog with
name MainWindow. init * functions are used to initialize the prototype (see above).</p>

<pre><code>function init__widget_name()
  MainWindow.a_widget:setValue(0)
  MainWindow.another_widget:setValue(0)
end
</code></pre>

<h2>
<a id="defining-prototyped-behavors" class="anchor" href="#defining-prototyped-behavors" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Defining prototyped behavors</h2>

<p>In order to define new prototyped behavior, a new file, say somebehavior.lua, is created
in the behavior/MainWindow/ folder. The following code is used to handle the click event
performed on the widget1 widget:</p>

<pre><code>value, result = 0

function click__widget1()
   value = MainWindow.widget2:value()
   calculateSomething()
end

function calculateSomething()
   result = ...
end
</code></pre>

<p>Supporting functions can be used along with behavior functions.</p>

<h2>
<a id="integrating-native-functionality" class="anchor" href="#integrating-native-functionality" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Integrating native functionality</h2>

<p>At some point during the development, prototyped behaviors are replaced with the corresponding native functionality. Native functionality is implemented, as usual, using C++ methods and functions. Once the native functionality is integrated into the implementation of the application (i.e., the *.h and *.cpp files) the corresponding prototyped behaviors need to be removed from the script files. </p>

<p>After recompiling and relaunching the application (needed to make native functionality work) the application will respond now with native functionality when the corresponding widget is interacted.</p>

<p>Go to <a href="http://www.catedrasaes.org/html/projects/sibap/sibap.html">http://www.catedrasaes.org/html/projects/sibap/sibap.html</a> for further project description.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">SIBAP prototyping maintained by <a href="https://github.com/pedromateo">pedromateo</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
